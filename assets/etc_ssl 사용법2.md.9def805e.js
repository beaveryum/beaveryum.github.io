import{_ as n,c as l,a as s,b as p,t as o,d as e,o as t}from"./app.a1a9e66d.js";const h=JSON.parse('{"title":"ssl 사용법2","description":"","frontmatter":{"title":"ssl 사용법2"},"headers":[],"relativePath":"etc/ssl 사용법2.md","lastUpdated":1674745074000}'),c={name:"etc/ssl 사용법2.md"},r={id:"frontmatter-title",tabindex:"-1"},D=s("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),y=e(`<p>ssl 사용방법에 대해서 다시 한번 남겨본다.</p><p><a href="https://www.happykoo.net/@happykoo/posts/210" target="_blank" rel="noreferrer">https://www.happykoo.net/@happykoo/posts/210</a></p><p>여기 사이트에 있던 소스를 가지고 하면된다.</p><p>우선 주의 사항을 좀 더 설명하자면</p><p>nginx conf에 꼭 ssl 관련된 소스코드가 있어야된다.</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">nginx</span><span style="color:#A6ACCD;">: </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">emerg</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> cannot load certificate </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/etc/letsencrypt/live/beaverfactory.com/fullchain.pem</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">BIO_new_file</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">failed</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">SSL</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> error</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">02001002</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">system library</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">fopen</span><span style="color:#89DDFF;">:No</span><span style="color:#A6ACCD;"> such file </span><span style="color:#89DDFF;">or</span><span style="color:#A6ACCD;"> directory</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;">fopen</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/etc/letsencrypt/live/beaverfactory.com/fullchain.pem</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">r</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> error</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">2006</span><span style="color:#A6ACCD;">D080</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">BIO routines</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">BIO_new_file</span><span style="color:#89DDFF;">:no</span><span style="color:#A6ACCD;"> such file</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><p>이런 에러가 나오는 이유는 소스코드가 풀 키체인 경로가 없어서 그럴수있다.</p><p>두번째로 는 아래 처럼 에러를 나올때</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">Domain</span><span style="color:#A6ACCD;">: beaverfactory</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">Type</span><span style="color:#A6ACCD;">:   connection</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">Detail</span><span style="color:#A6ACCD;">: </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">36</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">134</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">24</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> Fetching</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">http</span><span style="color:#A6ACCD;">:</span><span style="color:#676E95;font-style:italic;">//beaverfactory.com/.well-known/acme-challenge/v8LWKiAanUc-O3q0rm9M-XxWzIubA-np7u3mprodJWo:</span></span>
<span class="line"><span style="color:#A6ACCD;">  Timeout during </span><span style="color:#82AAFF;">connect</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">likely firewall problem</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">이거는 nginx 소스에 ssl 관련 스크립트가 없거나 해당 풀 키체인 경로를 지정 안해줘서 문제된거다</span></span>
<span class="line"></span></code></pre></div><p>마지막 아래 처럼 에러가 나올경우</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">An unexpected error occurred</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">There were too many requests of a given </span><span style="color:#FFCB6B;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;"> Error creating </span><span style="color:#F78C6C;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">order</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;"> too many failed authorizations recently</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> see https</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//letsencrypt.org/docs/failed-validation-limit/</span></span>
<span class="line"></span></code></pre></div><p>이거는 5번이내 실패 하면 에러가 나온다 1시간 이후에 명령어를 입력하라는뜻이다.</p><p>결론은 첫단추부터 중요하다</p><ol><li>ssl 관련 nginx에 넣기 풀 키체인이 경로에 지정 됐는지 확인해야한다.</li></ol><p>여기서 한가지 덧붙어 설명하자면 nginx conf 설정이 없는 상태에서 ssl을 생성 했더니 정상적으로 작동하는거를 확인 했다. 실수로 설정 파일을 이름만 default.conf1로 지정 하고 ssl 명령어를 실행 했더니 정상적으로 발급된다.</p><p>이게 좀 안전빵일수있어서.. 고민해서 다시 한번 문제되면 이런 방식으로 해보길.. (안되면 1시간 있다가 해야되서.. 잘 선택하길..)</p><ol start="2"><li>nginx 를 완벽히 중단시킬것 nginx -s stop &lt;&lt; 이걸로 하면 안된다 systemctl stop nginx로 아예 종료시켜야된다.</li></ol><p>아래처럼 메시지 문구가 나온거면 완료 됐다는 문구이다.</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">Found the following certs</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  Certificate Name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> beaverfactory</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span></span>
<span class="line"><span style="color:#A6ACCD;">    Serial Number</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">c8bff36034e9790942573e670597a0ca5f</span></span>
<span class="line"><span style="color:#A6ACCD;">    Key Type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> RSA</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Domains</span><span style="color:#A6ACCD;">: beaverfactory</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span></span>
<span class="line"><span style="color:#A6ACCD;">    Expiry Date</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">11</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">27</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">07</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">31</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">51</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">00</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">00</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">VALID</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">89</span><span style="color:#A6ACCD;"> days</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    Certificate Path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">etc</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">letsencrypt</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">live</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">beaverfactory</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">fullchain</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">pem</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Private</span><span style="color:#A6ACCD;"> Key Path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">etc</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">letsencrypt</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">live</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">beaverfactory</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">privkey</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">pem</span></span>
<span class="line"></span></code></pre></div><p>이렇게 해서 갱신 명령어를 써주면될것이다. 5번이내 실패를 하면 한시간 이후에 해야되서.. 실패 없이 입력할것!</p><p>일단 여기까지 개발일지 써놓고 다음에 다시 새로 올려놓을것이다.</p>`,21);function C(a,F,A,i,d,f){return t(),l("div",null,[s("h1",r,[p(o(a.$frontmatter.title)+" ",1),D]),y])}const u=n(c,[["render",C]]);export{h as __pageData,u as default};
